\begin{Algoritmos} \\
    \noindent \makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\textbf{iniciar}(\textbf{in \ }m: \ Mapa) \ $\longrightarrow$ \ res \ : \ estr\\
1: \  \ estr.turno \ $\leftarrow$ \ 0\\
2: \  \ estr.antiguedad \ $\leftarrow$ \ 0\\
3: \  \ estr.popularidad \ $\leftarrow$ \ 0\\
4: \  \ estr.mapa \ $\leftarrow$ \ m\\
5: \  \ estr.construcciones \ $\leftarrow$ \ vacio()\\
6: \  \ estr.uniones \ $\leftarrow$ \ vacia()\\
7: \  \ \textbf{return} \ estr\\
\textbf{Complejidad}: \ O(1)\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\textbf{avanzarTurno}(\textbf{inout} \ SimCity \ s, \  \ \textbf{in \ }dicc(Pos, \ Construccion) \ cs)\\
1: \  \ s.turno \ $\leftarrow$ \ s.turno \ + \ 1 \ \\
2: \  \ s.construcciones.agregarAtras(direccion(cs))\\
\textbf{Complejidad}: \ O(1)\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\textbf{unir}(\textbf{inout} \ SimCity \ s1, \  \ \textbf{inout} \ Simcity \ s2)\\
1: \  \ s1.popularidad \ $\leftarrow$ \ s1.popularidad \ + \ s2.popularidad \ + \ 1\\
2: \  \ s1.antiguedad \ $\leftarrow$ \ max(s1.antiguedad, \ s2.antiguedad)\\
3: \  \ hijo \ nuevoHijo \ $\leftarrow$ \ $<$direccion(s2), \ s1.turno$>$\\
4: \  \ agregarAtras(s1.uniones, \ nuevoHijo)\\
\textbf{Complejidad}: \ O(1)\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\\
Asumo \ que \ existe \ un \ conjunto \ U \ $\equiv$ \ \{u$_1$, \ u$_2$, \ ... \ , \ u$_n$\}\\
tal \ que \ cada \ uno \ de \ esos \ u$_i$ \ son \ los \ simcities \ que \ componen \ al \ simcity \ original\\
llamamos \ nodos \ : \ $ \# $U\\
llamamos \ sumConstrucciones \ : \ $\sum_{i=1\}^{nodos}$(copiar(u$_i$.construcciones))\\
llamamos \ sumMapas \ : \ $\sum_{i=1}^{nodos}$(u$_i$.mapa)\\
\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\textbf{mapa}(\textbf{in \ }SimCity \ s) \ $\rightarrow $ \ res \ : \ Mapa \ \\
1: \  \ Mapa \ res \ $\leftarrow$ \ s.mapa\\
2: \  \ \textbf{for}(nat \ i \ $\leftarrow$ \ 0; \ i \ $<$ \ long(s.uniones); \ i \ $\leftarrow$ \ i \ + \ 1) \ : \ \\
3:\indent  \  \ res \ $\leftarrow$ \ res \ + \ \textbf{mapa}(*s.uniones[i].sc)\\
4: \  \ \textbf{return} \ res\\
\textbf{Complejidad}: \ O(sumMapas) \ \\
cabe \ aclarar \ que \ la \ suma \ de \ los \ mapas \ esta \ definida\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\textbf{listDeTipo}(\textbf{in \ }SimCity \ s, \ \textbf{in \ }Construccion \ tipo) \ $\rightarrow $ \ res \ : \ dicc(Pos, \ Nivel)\\
1: \  \ dicc(pos, \ nivel) \ res \ $\leftarrow$ \ vacio()\\
2: \  \ \textbf{for}(nat \ i \ $\leftarrow$ \ 0; \ i \ $<$ \ long(s.construcciones); \ i \ $\leftarrow$ \ i \ + \ 1) \ : \ \\
3:\indent  \  \ itDicc(Pos, \ Construccion) \ itCs \ $\leftarrow$ \ crearIt(*s.construcciones[i]);\\
4:\indent  \  \ \textbf{while}(haySiguiente(itCs)) \ :\\
5:\indent \indent  \  \ Pos \ p \ $\leftarrow$ \ siguienteClave(itCs)\\
6:\indent \indent  \  \ construccion \ c \ $\leftarrow$ \ siguienteSignificado(itCs)\\
7:\indent \indent  \  \ \textbf{if}(c \ == \ tipo) \ :\\
8:\indent \indent \indent  \  \ definir(res, \ p, \ s.turno \ - \ (i+1))\\
9:\indent \indent  \  \ avanzar(itCs) \ \\
\textbf{Complejidad}: \ O($\sum_{i = 0}^{long(s.construcciones)}$(\# claves(*s.construcciones[i])))\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\textbf{casas}(\textbf{in \ }SimCity \ s) \ $\rightarrow $ \ res \ : \ dicc(Pos, \ Nivel)\\
1: \  \ dicc(pos, \ nivel) \ res \ $\leftarrow$ \ copiar(listDeTipo(s, \ ``casa''))\\
2: \  \ dicc(pos, \ nivel) \ comerciosTotales \ $\leftarrow$ \ copiar(listDeTipo(s, \ ``comercio''))\\
3: \  \ \textbf{for}(nat \ i \ $\leftarrow$ \ 0; \ i \ $<$ \ long(s.uniones); \ i \ $\leftarrow$ \ i \ + \ 1) \ : \ \\
4:\indent  \  \ itDicc(Pos, \ Nivel) \ itCs \ $\leftarrow$ \ crearIt(\textbf{casas}(*s.uniones[i].sc))\\
5:\indent  \  \ \textbf{while}(haySiguiente(itCs)) \ :\\
6:\indent \indent  \  \ Pos \ p \ $\leftarrow$ \ siguienteClave(itCs)\\
7:\indent \indent  \  \ Nivel \ n \ $\leftarrow$ \ siguienteSignificado(itCs)\\
8:\indent \indent  \  \ \textbf{if}($\neg$def?(res, \ p) \ $\wedge$ \ $\neg$def?(comerciosTotales, \ p)) \ :\\
9:\indent \indent \indent  \  \ definir(res, \ p, \ s.turno \ - \ s.uniones[i].turnoUnido \ + \ n)\\
10:\indent \indent  \ avanzar(itCs)\\
11:\indent  \ comerciosTotales \ $\leftarrow$ \ comerciosTotales \ $\cup$ \ listDeTipo(*s.uniones[i].sc, \ ``comercio'')\\
12: \ \textbf{return} \ res\\
\textbf{Complejidad}: \ O([sumConstrucciones]$^2$ \ + \ nodos)\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\textbf{comercios}(\textbf{in \ }SimCity \ s) \ $\rightarrow $ \ res \ : \ dicc(Pos, \ Nivel)\\
1: \  \ dicc(Pos, \ Nivel) \ casasTotales \ $\leftarrow$ \ casas(s)\\
2: \  \ \textbf{return} \ manhatizar(comerciosAux(s, \ casasTotales), \ casasTotales)\\
\textbf{Complejidad}: \ O(manhatizar(comerciosAux(s, \ casasTotales), \ casasTotales) \ + \ casas(s))\\
\\
\textbf{comerciosAux}(\textbf{in \ }SimCity \ s, \ \textbf{in \ }casasTotales) \ $\rightarrow $ \ res \ : \ dicc(Pos, \ Nivel)\\
1: \  \ dicc(pos, \ nivel) \ res \ $\leftarrow$ \ copiar(listDeTipo(s, \ ``casa''))\\
3: \  \ \textbf{for}(nat \ i \ $\leftarrow$ \ 0; \ i \ $<$ \ long(s.uniones); \ i \ $\leftarrow$ \ i \ + \ 1) \ : \ \\
4:\indent  \  \ itDicc(Pos, \ Nivel) \ itCs \ $\leftarrow$ \ crearIt(\textbf{comerciosAux}(*s.uniones[i].sc), \ casasTotales)\\
5:\indent  \  \ \textbf{while}(haySiguiente(itCs)) \ :\\
6:\indent \indent  \  \ Pos \ p \ $\leftarrow$ \ siguienteClave(itCs)\\
7:\indent \indent  \  \ Nivel \ n \ $\leftarrow$ \ siguienteSignificado(itCs)\\
8:\indent \indent  \  \ \textbf{if}($\neg$def?(res, \ p) \ $\wedge$ \ $\neg$def?(casasTotales, \ p)) \ :\\
9:\indent \indent \indent  \  \ definir(res, \ p, \ s.turno \ - \ s.uniones[i].turnoUnido \ + \ n)\\
10:\indent \indent  \ avanzar(itCs)\\
11: \ \textbf{return} \ res\\
\textbf{Complejidad}: \ O([sumConstrucciones]$^2$ \ + \ nodos)\\
\\
\textbf{manhatizar}(\textbf{inout} \ dicc(Pos, \ Nivel) \ comercios, \ \textbf{in \ }dicc(Pos, \ Nivel) \ casasTotales) \ \{\\
1: \  \ itDicc(Pos, \ Nivel) \ itCs \ $\leftarrow$ \ crearIt(comercios)\\
2: \  \ \textbf{while}(haySiguiente(itCs)) \ :\\
3:\indent  \  \ Pos \ p \ $\leftarrow$ \ siguienteClave(itCs)\\
4:\indent  \  \ Nivel \ n \ $\leftarrow$ \ siguienteSignificado(itCs)\\
5:\indent  \  \ eliminarSiguiente(itCs)\\
6:\indent  \  \ definirRapido(comercios, \ p, \ max(n, \ nivelCom(p, \ casasTotales)))\\
7:\indent  \  \ avanzar(itCs)\\
\}\\
\textbf{Complejidad}: \ O($ \# $claves(comercios) \ * \ $ \# $claves(casasTotales))\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\textbf{popularidad}(\textbf{in \ }SimCity \ s) \ $\rightarrow $ \ res \ : \ Nat\\
1: \  \ \textbf{return} \ s.popularidad\\
\textbf{Complejidad}: \ O(1)\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\textbf{nivelCom}(\textbf{in \ }Pos \ p, \ \textbf{in \ }dicc(pos, \ Nivel) \ cs) \ $\rightarrow $ \ Nat\\
1: \  \ nat \ maxLvl \ $\leftarrow$ \ 1\\
2: \  \ \textbf{for}(int \ i \ = \ -3; \ i \ $\leq$ \ 3; \ ++i) \ :\\
3:\indent  \  \ \textbf{for}(int \ j \ = \ $\mid$i$\mid$-3; \ j \ $\leq$ \ 3-$\mid$i$\mid$; \ ++j) \ :\\
4:\indent \indent  \  \ \textbf{if}(p.x \ + \ i \ $\geq$ \ 0 \ $\wedge$ \ p.y \ + \ j \ $\geq$ \ 0) \ :\\
5:\indent \indent \indent  \  \ Pos \ p2 \ $\leftarrow$ \ $<$p.x+i, \ p.y+j$>$ \ \\
6:\indent \indent \indent  \  \ \textbf{if}(def?(cs, \ p2)) \ :\\
7:\indent \indent \indent \indent  \  \ maxLvl \ = \ max(maxLvl, \ obtener(cs, \ p2))\\
8: \  \ \textbf{return} \ maxLvl\\
\textbf{Complejidad}: \ O($ \# $claves(cs))\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\textbf{agCasa}(\textbf{inout} \ dicc(Pos, \ Nivel) \ casas, \ \textbf{in \ }Pos \ p, \ \textbf{in \ }Nivel \ n) \ :\\
1: \  \ definirRapido(casas, \ p, \ n)\\
\textbf{Complejidad}: \ O(1)\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\textbf{agComercio}(\textbf{inout} \ dicc(Pos, \ Nivel) \ comercios, \ \textbf{in \ }Pos \ p, \ \textbf{in \ }Nivel \ n) \ :\\
1: \  \ definirRapido(comercio, \ p, \ n)\\
\textbf{Complejidad}: \ O(1)\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\textbf{turnos}(\textbf{in \ }SimCity \ s) \ $\rightarrow $ \ res \ : \ Nat\\
1: \  \ \textbf{return} \ s.turno\\
\textbf{Complejidad}: \ O(1)\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
$\bullet$ \ $\cup$ \ $\bullet$(\textbf{in \ }dicc($\alpha$, \ $\beta$) \ d1, \ \textbf{in \ }dicc($\alpha$, \ $\beta$) \ d2) \ $\rightarrow $ \ res \ : \ dicc($\alpha$, \ $\beta$)\\
1: \  \ dicc($\alpha$, \ $\beta$) \ res \ = \ copiar(d1)\\
2: \  \ itDicc($\alpha$, \ $\beta$) \ itCs \ $\leftarrow$ \ crearIt(d2);\\
3: \  \ \textbf{while}(haySiguiente(itCs)) \ :\\
4:\indent  \  \ $\alpha$ \ a \ $\leftarrow$ \ siguienteClave(itCs)\\
5:\indent  \  \ $\beta$ \ b \ $\leftarrow$ \ siguienteSignificado(itCs)\\
6:\indent  \  \ \textbf{if}($\neg$def?(res, \ a)) \ :\\
7:\indent \indent  \  \ definir(res, \ a, \ b)\\
8:\indent  \  \ avanzar(itCs)\\
9: \  \ \textbf{return} \ res\\
\textbf{Complejidad}: \ O(copy(d1) \ + \ $ \# $claves(d2))\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
\textbf{construcc}(\textbf{in \ }SimCity \ s) \ $\rightarrow $ \ res \ : \ Nat\\
1: \  \ \textbf{return} \ \textbf{casas}(s) \ $\cup$ \ \textbf{comercios}(s)\\
\textbf{Complejidad}: \ O(\textbf{casas}(d1) \ + \ \textbf{comercios}(d2))\\
\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}\\
\end{Algoritmos}

