\begin{tad}{\tadNombre{Servidor}}
    \vspace{0.5mm}

    \tadGeneros{Server}
    \vspace{2mm}
    
    \tadExporta{Server, observadores,\ generadores,\ verMapa,\ verCasas,\ verComercios,\ verPopularidad y\\ verTurno}
    \vspace{2mm}
    
    \tadUsa{SimCity,\ Mapa,\ Nombre,\ Pos,\ Construcción,\ Nivel,\ Nat,\ Bool,\ dicc($\alpha$ $\times$ $\beta$),\ conj($\alpha$)}
    \vspace{2mm}
    
    \tadIgualdadObservacional{s}{s'}{Server}{
        partidas($s$) $\igobs$ partidas($s'$) \yluego \\
        congeladas($s$) $\igobs$ congeladas($s'$) $\land$ \\
        ($\forall$ $p$: Nombre)(def?($p$, partidas($s$)) \impluego \\
        \tab pendientes($s,\ p$) $\igobs$ pendientes($s',\ p$))
    }
    \vspace{2mm}

    \tadObservadores
    \tadAlinearFunciones{pendientes}{Server/s, Nombre/p}
    \tadOperacion{partidas}{Server}{dicc(Nombre $\times$ SimCity)}{}
    \tadOperacion{congeladas}{Server}{conj(Nombre)}{}
    \tadOperacion{pendientes}{Server/s, Nombre/p}{dicc(Pos $\times$ Construcción)}{def?($p$, partidas($s$))}        
    \vspace{2mm}

    \tadGeneradores
    \tadAlinearFunciones{agregarComercio}{Server /s, Nombre /p1, Nombre /p2}
    \tadOperacion{nuevoServer}{}{Server}{}
    \tadOperacion{nuevaPartida}{Server /s, Nombre /p, Mapa}{Server}{$\neg$ def?($p$, partidas($s$))}
    \tadOperacion{unirPartidas}{Server /s, Nombre /p1, Nombre /p2}{Server}{unionValida($s$, $p1$, $p2$)$^{1}$}
    \tadOperacion{agregarCasa}{Server /s, Nombre  /p, Pos /pos}{Server}{agregarValido($s$, $p$, $pos$)$^{1}$}
    \tadOperacion{agregarComercio}{Server /s, Nombre /p, Pos /pos}{Server}{agregarValido($s$, $p$, $pos$)$^{1}$}
    \tadAlinearFunciones{avanzarTurnoPartida}{Server /s, Nombre /p1, Nombi}
    \tadOperacion{avanzarTurnoPartida}{Server /s, Nombre /p}{Server}{avanzarValido($s$, $p$)$^{1}$} 
    \vspace{2mm}
    
    \tadOtrasOperaciones
    \tadAlinearFunciones{verPopularidad}{Server /s, Nombre /p}
    \tadOperacion{verMapa}{Server /s, Nombre /p}{Mapa}{def?($p$, partidas($s$))}
    \tadOperacion{verCasas}{Server /s, Nombre /p}{dicc(Pos $\times$ Nivel)}{def?($p$, partidas($s$))}        
    \tadOperacion{verComercios}{Server /s, Nombre /p}{dicc(Pos $\times$ Nivel)}{def?($p$, partidas($s$))}
    \tadOperacion{verPopularidad}{Server /s, Nombre /p}{Nat}{def?($p$, partidas($s$))}
    \tadOperacion{verTurno}{Server /s, Nombre /p}{Nat}{def?($p$, partidas($s$))}
    \vspace{2mm}

    \tadAxiomas
    [
        \paratodo{Server}{s}, 
        \paratodo{Nombre}{p,\ p',\ p''}, 
        \paratodo{Mapa}{m},
        \paratodo{Pos}{pos}
    ]
    \tadAlinearAxiomas{partidas(agregarComercio(s,\ p,\ pos))}
    \tadAxioma{partidas(nuevoServer)}{
        vacio
    }
    \tadAxioma{partidas(nuevaPartida($s$,\ $p$,\ $m$))}{
        definir($p$,\ iniciar($m$),\ partidas($s$))
    }
    \tadAxioma{partidas(unirPartidas($s$,\ $p$,\ $p'$))}{
        definir($p1$,\ $\\$ 
        \tab unir(obtener($p1$,\ partidas($s$)),\ obtener($p2$,\ partidas($s$))), %$\\$ 
        \tab partidas($s$))
    }
    \tadAxioma{partidas(agregarCasa($s$,\ $p$,\ $pos$))}{
        partidas($s$)
    }
    \tadAxioma{partidas(agregarComercio($s$,\ $p$,\ $pos$))}{
        partidas($s$)
    }
    \tadAxioma{partidas(avanzarTurnoPartida($s$,\ $p$))}{
        definir($p$,\ $\\$
        \tab avanzarTurno(obtener($p$,\ partidas($s$)),\ pendientes($s$,\ $p$)), %$\\$
        \tab partidas($s$))
    }
    \vspace{2mm}
    
    \tadAlinearAxiomas{congeladas(agregarComercio(s,\ p,\ pos))}
    \tadAxioma{congeladas(nuevoServer)}{$\emptyset$}         
    \tadAxioma{congeladas(nuevaPartida($s$,\ $p$,\ $m$))}{congeladas($s$)}
    \tadAxioma{congeladas(unirPartidas($s$,\ $p$,\ $p'$))}{Ag($p'$,\ congeladas($s$))}
    \tadAxioma{congeladas(agregarCasa($s$,\ $p$,\ $pos$))}{congeladas($s$)}
    \tadAxioma{congeladas(agregarComercio($s$,\ $p$,\ $pos$))}{congeladas($s$)}
    \tadAxioma{congeladas(avanzarTurnoPartida($s$,\ $p$))}{congeladas($s$)}
    \vspace{2mm}

\pie{
    \vfill{}
    \item definido en el apartado Definiciones Auxiliares de Servidor.
}
\newpage

    \tadAlinearAxiomas{pendientes(agregarComercio(s,\ p,\ pos), p')}
    \tadAxioma{pendientes(nuevaPartida($s$,\ $p$,\ $m$),\ $p'$)}{
        $\LIF$\ $p$ = $p'$\ $\LTHEN$\ vacio\ $\LELSE$\ pendientes($s$,\ $p'$)\ $\LFI$
    }
    \tadAxioma{pendientes(unirPartidas($s$,\ $p$,\ $p'$),\ $p''$)}{
        pendientes($s$,\ $p''$) \textcolor{red}{acá no hace falta dif casos no?}
    }
    \tadAxioma{pendientes(agregarCasa($s$,\ $p$,\ $pos$),\ $p'$)}{
        $\LIF$\ $p$ = $p'$\ $\LTHEN$\ $\\$
        \tab definir($pos$,\ $"casa"$,\ pendientes($s$,\ $p$)) $\\$
        $\LELSE$\ $\\$
        \tab pendientes($s$,\ $p'$)\ $\\$
        $\LFI$
    }
    \tadAxioma{pendientes(agregarComercio($s$,\ $p$,\ $pos$), $p'$)}{
        $\LIF$\ $p$ = $p'$\ $\LTHEN$\ $\\$
        \tab definir($pos$,\ $"comercio"$,\ pendientes($s$,\ $p$)) $\\$
        $\LELSE$\ $\\$
        \tab pendientes($s$,\ $p'$)\ $\\$
        $\LFI$
    }     
    \tadAxioma{pendientes(avanzarTurnoPartida($s$,\ $p$),\ $p'$)}{
        $\LIF$\ $p$ = $p'$\ $\LTHEN$\ vacio\ $\LELSE$\ pendientes($s$,\ $p'$)\ $\LFI$
    } 
        
    \vspace{2mm}
    \tadEncabezado{otros ax.}{\paratodo{Server}{s},\ \paratodo{Nombre}{p}}
    \vspace{1mm}

    \tadAlinearAxiomas{verPopularidad($s$,\ $p$)}
    \tadAxioma{verMapa($s$,\ $p$)}{
        mapa(obtener($p$,\ partidas($s$)))
    }
    \tadAxioma{verCasas($s$,\ $p$)}{
        casas(obtener($p$,\ partidas($s$)))
    }
    \tadAxioma{verComercios($s$,\ $p$)}{
        comercios(obtener($p$,\ partidas($s$)))
    }
    \tadAxioma{verPopularidad($s$,\ $p$)}{
        popularidad(obtener($p$,\ partidas($s$)))
    }
    \tadAxioma{verTurno($s$,\ $p$)}{
        turnos(obtener($p$,\ partidas($s$)))
    }
    \vspace{1mm}
        
\end{tad}

\vspace{5mm}
\Titulo{Definiciones Auxiliares de Servidor}
\vspace{3mm}

\tadOperacion{unionValida}{Server, Nombre, Nombre}{boolean}{}
\tadAxioma{unionValida($s$,\ $p$,\ $p'$)}{
        def?($p$,\ partidas($s$))\ $\land$\ def?($p'$,\ partidas($s$))\ $\land$\ $p$\ $\notin$\ congeladas($s$)\ $\yluego$\ $\\$
        %\land\ p'\ \notin\ congeladas(s)\ 
        vacio?(claves(pendientes($s$,\ $p$)))\ $\land$\ vacio?(claves(pendientes($s$,\ $p'$)))\ $\land$\ $\\$
        unirValido(obtener($p$,\ partidas($s$)), obtener($p'$,\ partidas($s$)))$^{1}$           
}
\vspace{2mm}

\tadOperacion{avanzarValido}{Server, Nombre}{boolean}{}
\tadAxioma{avanzarValido($s$,\ $p$)}{
        def?($p$,\ partidas($s$))\ $\land$\ $p$\ $\notin$\ congeladas($s$)\ $\yluego$\ $\\$
        $\neg$ vacio?(claves(pendientes(obtener($p$, partidas($s$)))))\ 
}
\vspace{2mm}

\tadOperacion{agregarValido}{Server, Nombre, Pos}{boolean}{}
\tadAxioma{agregarValido($s$, $p$, $pos$)}{
        def?($p$, partidas($s$))\ $\land$\ $p$ $\notin$ congeladas($s$)\ $\wedge$\  
        $\lnot$ def?($pos$,\ pendientes($s$,\ $p$))\ $\land$ $\\$
        $\lnot$ def?($pos$, verCasas($s$, $p$))\ $\wedge$\ $\lnot$ def?($pos$, verComercios($s$, $p$))\ $\wedge$\ $\\$
        $\lnot$ esRio($pos$,\ verMapa($s$,\ $p$))
}

\pie{
    \vfill{}
    \item definido en el apartado Definiciones Auxiliares de SimCity.
}
